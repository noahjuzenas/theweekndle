/* ---------- Theme tokens ---------- */
:root{
  --bg:#0b0b0b;
  --text:#f2f2f2;
  --muted:#b8b8b8;
  --accent:#1db954;

  --border:#333;

  --radius:14px;
  --radius-sm:10px;

  --space-1:8px;
  --space-2:12px;
  --space-3:16px;
  --space-4:20px;

  /* table sizing */
  --guess-row-h: 64px;

  /* row “card” palette */
  --row-grad-1: rgba(30,30,44,.88);
  --row-grad-2: rgba(16,16,26,.88);
  --row-shadow: 0 8px 22px rgba(0,0,0,.28);
}

/* ---------- Base ---------- */
html, body { background: var(--bg); color: var(--text); }
body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Inter, Arial, sans-serif;
  line-height: 1.4; margin: 0; padding: var(--space-3); text-align: center;
}

/* ---------- Header ---------- */
header{
  padding: 20px; display:flex; flex-direction:column; align-items:center;
  border-bottom: 1px solid var(--border);
}
header h1{ margin:0; font-size: clamp(1.6rem, 3.6vw, 2.6rem); }
.header-controls{ display:flex; align-items:center; gap:12px; margin-top:8px; }
#countdown{ font-size:.9rem; color:var(--muted); }

/* ---------- Inputs & buttons ---------- */
input{
  padding:10px 12px; font-size:16px; border-radius:6px;
  border:1px solid var(--border); background:#111; color:var(--text);
}
button{
  padding:10px 14px; font-size:16px; margin-left:6px; cursor:pointer;
  background: var(--accent); border:none; border-radius:6px; color:#000;
}

/* ---------- Autocomplete ---------- */
.autocomplete{ position:relative; display:inline-block; }
.autocomplete-items{
  position:absolute; z-index:30; top:100%; left:0; right:0;
  background:#111; border:1px solid #232323; max-height:45vh; overflow:auto;
  border-radius: var(--radius-sm);
}
.autocomplete-items div{ padding:10px var(--space-3); cursor:pointer; color:#fff; border-bottom:1px solid #1f1f1f; }
.autocomplete-items div:last-child{ border-bottom:0; }
.autocomplete-active{ background:#1c1c1c !important; color:#fff; }

/* ---------- Table (alignment-safe + card rows) ---------- */
table{ margin:20px auto; width:90%; }

#guessesTable{
  table-layout: fixed;
  width:90%;
  border-collapse: separate;          /* we want spacing between rows */
  border-spacing: 0 12px;             /* vertical gap between rows */
}

/* header */
#guessesTable thead th{
  padding:10px;
  border:none;
  text-align:center;
  font-weight:bold;
  vertical-align:middle;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* body cells: base gradient for neutral/incorrect */
#guessesTable tbody td{
  padding:10px;
  border:none;
  text-align:center;
  font-weight:bold;
  vertical-align:middle;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;

  background: linear-gradient(180deg, var(--row-grad-1), var(--row-grad-2));
  background-clip: padding-box;
}

/* column widths */
#guessesTable .col-guess{ width:4%; }
#guessesTable .col-song{ width:36%; }
#guessesTable .col-album{ width:30%; }
#guessesTable .col-track{ width:8%; }
#guessesTable .col-duration{ width:10%; }
#guessesTable .col-streams{ width:12%; }

/* row height */
#guessesTable tbody tr{ height: var(--guess-row-h); }

/* outer corners + shadow on the row card */
#guessesTable tbody tr td:first-child{
  border-top-left-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
  box-shadow: var(--row-shadow);
}
#guessesTable tbody tr td:last-child{
  border-top-right-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
}

/* album cell layout */
#guessesTable td.album-cell{
  padding-top:0; padding-bottom:0; padding-left:8px;
  display:grid; grid-template-columns: var(--guess-row-h) 1fr; align-items:center; gap:8px;
}
#guessesTable td.album-cell img{
  width: var(--guess-row-h); height: var(--guess-row-h); object-fit:cover; display:block; border-radius:10px;
}
.album-text{ min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* feedback chips (merge when adjacent; keep only outer corners if at edges) */
#guessesTable tbody td.green,
#guessesTable tbody td.yellow{
  border-radius: 0 !important;            /* flat inner edges so chips touch */
  font-weight: 800;
}
#guessesTable tbody td.green{
  background: linear-gradient(180deg, rgba(0,220,70,.96), rgba(0,185,60,.96)) !important;
  color:#06140b !important;
}
#guessesTable tbody td.yellow{
  background: linear-gradient(180deg, rgba(246,206,38,.96), rgba(233,183,21,.96)) !important;
  color:#1a1304 !important;
}
/* preserve outer rounding if the first/last cell is highlighted */
#guessesTable tbody tr td:first-child.green,
#guessesTable tbody tr td:first-child.yellow{
  border-top-left-radius: var(--radius) !important;
  border-bottom-left-radius: var(--radius) !important;
}
#guessesTable tbody tr td:last-child.green,
#guessesTable tbody tr td:last-child.yellow{
  border-top-right-radius: var(--radius) !important;
  border-bottom-right-radius: var(--radius) !important;
}

/* winning row */
#guessesTable tr.win-row td{
  background: linear-gradient(180deg, rgba(0,220,70,.98), rgba(0,185,60,.98)) !important;
  color:#03140a !important;
  font-weight: 900;
}

/* ---------- Overlays ---------- */
.overlay{
  position:fixed; display:none; inset:0; background: rgba(0,0,0,.85);
  justify-content:center; align-items:center; z-index:1000; padding: var(--space-3);
}
.overlay-card{
  background:#222; color:#fff; text-align:center;
  width:min(680px,92vw); max-height:90vh; overflow-y:auto; -webkit-overflow-scrolling:touch;
  padding:20px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.6);
}
img#albumCover, img#lossAlbumCover{
  width:80%; max-width:400px; height:auto; display:block; margin:15px auto; border-radius:10px;
}

/* popup titles */
#winSongTitle{ font-size:2.2em; font-weight:800; line-height:1.2; margin:8px 0 12px; }
.loss-song{ font-size:1.6em; font-weight:700; line-height:1.2; margin:6px 0 10px; }

/* Guess distribution */
.gd-heading{ margin:16px 0 8px; font-size:1.05rem; font-weight:700; }
#guessDist .gd-row{ display:flex; align-items:center; gap:8px; margin:4px 0; }
#guessDist .gd-num{ width:20px; text-align:right; opacity:.9; }
#guessDist .gd-bar{ flex:1; height:14px; background:#333; border-radius:8px; overflow:hidden; }
#guessDist .gd-bar>div{ height:100%; background:#1db954; text-align:right; padding-right:6px; font-size:12px; line-height:14px; }

/* Scroll lock */
body.modal-open{ overflow:hidden; }

/* Footer links */
#footerLinks{
  position:fixed; right:14px; bottom:14px; display:flex; flex-direction:column; align-items:flex-end; gap:4px;
  font-size:14px; z-index:10;
}
#footerLinks a{ color:#aab8af; text-decoration:none; opacity:.9; }
#footerLinks a:hover{ text-decoration:underline; opacity:1; }

/* ---------- Mobile ---------- */
@media (max-width:700px){
  html{ font-size:13px !important; }
  body,p,li,td,th,input,button{ font-size:.92rem !important; line-height:1.25 !important; }
  h1{ font-size:1.4rem !important; margin:10px 0 6px !important; }

  #guessesTable{ width:100%; }
  #guessesTable thead th{ font-size:.78rem !important; padding:8px !important; text-transform:uppercase; letter-spacing:.02em; }
  #guessesTable tbody td{ font-size:.9rem !important; padding:8px !important; }

  /* Artwork-only on phones */
  .album-cell .album-text{
    position:absolute !important; width:1px !important; height:1px !important;
    margin:-1px !important; padding:0 !important; overflow:hidden !important;
    clip:rect(0 0 0 0) !important; white-space:nowrap !important; border:0 !important;
  }
  td.album-cell{
    display:grid !important; grid-template-columns:1fr !important;
    align-items:center !important; justify-items:center !important;
    padding-top:6px !important; padding-bottom:6px !important;
  }
  td.album-cell img{
    width:34px !important; height:34px !important; object-fit:cover !important; border-radius:8px !important;
  }

  /* Column rebalance */
  #guessesTable .col-song{ width:40% !important; }
  #guessesTable .col-album{ width:12% !important; }
  #guessesTable .col-track{ width:15% !important; }
  #guessesTable .col-duration{ width:17% !important; }
  #guessesTable .col-streams{ width:16% !important; }
}

@media (max-width:480px){
  html{ font-size:12px !important; }
  #guessesTable thead th{ font-size:.72rem !important; }
  #guessesTable tbody td, .album-cell .album-text{ font-size:.82rem !important; }
  #guessInput, #guessBtn, #seeResultsBtn{ font-size:.9rem !important; }
}

@media (max-width:380px){
  td.album-cell img{ display:block !important; }
}

/* Hide Streams on ultra-narrow phones if necessary */
@media (max-width:340px){
  #guessesTable thead th:nth-child(6),
  #guessesTable tbody td:nth-child(6){ display:none; }
}
/* ---------- Page background gradient ---------- */
html, body {
  height: 100%;
  background:
    radial-gradient(1200px 800px at 10% -10%, rgba(109, 67, 226, 0.25), transparent 0%),
    radial-gradient(1000px 700px at 100% 0%, rgba(127, 0, 0, 0.18), transparent 0%),
    linear-gradient(180deg, #0b0b0f, #131320);
  color: var(--text);
  margin: 0;
  padding: 0;
}

/* Subtle animated grain overlay */
body::before {
  content: "";
  position: fixed; inset: 0;
  pointer-events: none;
  z-index: 0;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" opacity="0.07"><filter id="f"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23f)" /></svg>');
  mix-blend-mode: overlay;
}

/* ===== How-to popup repair & polish ===== */

/* Ensure it floats above grain/background and other UI */
#howToPlayOverlay {
  z-index: 2000;                 /* higher than anything else */
}

/* Card look with proper spacing/width and blur */
#howToPlayOverlay .overlay-card {
  width: min(1000px, 95vw);
  background: linear-gradient(180deg, rgba(24,24,36,.96), rgba(14,14,24,.96));
  border: 1px solid rgba(255,255,255,.08);
  backdrop-filter: blur(8px);
  padding: 22px 22px 18px;
  border-radius: 16px;
  box-shadow: 0 20px 50px rgba(0,0,0,.55);
  text-align: left;              /* read like a sheet */
}

/* Headings & body text */
#howToPlayOverlay h2 {
  margin: 0 0 10px;
  font-size: clamp(20px, 3.2vw, 28px);
  font-weight: 800;
}
#howToPlayOverlay .how-to-directions p {
  margin: 6px 0 10px;
  color: #e9eaf0;
}

/* Bullet list restored (was getting cramped/unstyled) */
#howToPlayOverlay .how-to-directions ul {
  margin: 8px 0 14px 22px;       /* left indent for bullets */
  padding: 0;
  list-style: disc;
}
#howToPlayOverlay .how-to-directions li {
  margin: 6px 0;
  line-height: 1.35;
  color: #cfd3de;
}

/* Album art strip: tidy grid, consistent sizing */
#howToPlayOverlay .how-to-albums {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(84px, 1fr));
  gap: 12px;
  margin: 10px 0 14px;
}
#howToPlayOverlay .how-to-albums img {
  width: 100%;
  height: 84px;
  object-fit: cover;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 6px 18px rgba(0,0,0,.35);
}

/* Close button */
#howToPlayOverlay #closeHowTo {
  display: inline-block;
  margin-top: 6px;
  padding: 10px 14px;
  border: none;
  border-radius: 10px;
  font-weight: 700;
  cursor: pointer;
  color: #0b0b0f;
  background: linear-gradient(180deg, #bca8ff, #7a5cff);
  box-shadow: 0 10px 18px rgba(122,92,255,.3), inset 0 -2px 0 rgba(0,0,0,.2);
}

/* Prevent table/card styles from leaking in */
#howToPlayOverlay .overlay-card table,
#howToPlayOverlay .overlay-card th,
#howToPlayOverlay .overlay-card td {
  all: unset;
}

/* ===== Unified gradient style for all action buttons ===== */
#howToPlayBtn,
#guessBtn,
#seeResultsBtn,
#shareScoreBtn,
#shareLossBtn,
#closeWinBtn,
#closeLossBtn,
#closeHowTo {
  background: linear-gradient(180deg, #bca8ff, #7a5cff) !important;
  color: #0b0b0f !important;
  font-weight: 700;
  border: none;
  border-radius: 10px;
  padding: 10px 14px;
  cursor: pointer;
  box-shadow:
    0 10px 18px rgba(122,92,255,.3),
    inset 0 -2px 0 rgba(0,0,0,.2);
  transition: transform .08s ease, box-shadow .12s ease;
}

#howToPlayBtn:hover,
#guessBtn:hover,
#seeResultsBtn:hover,
#shareScoreBtn:hover,
#shareLossBtn:hover,
#closeWinBtn:hover,
#closeLossBtn:hover,
#closeHowTo:hover {
  transform: translateY(-1px);
  box-shadow:
    0 12px 22px rgba(122,92,255,.4),
    inset 0 -2px 0 rgba(0,0,0,.25);
}

#howToPlayBtn:active,
#guessBtn:active,
#seeResultsBtn:active,
#shareScoreBtn:active,
#shareLossBtn:active,
#closeWinBtn:active,
#closeLossBtn:active,
#closeHowTo:active {
  transform: translateY(0);
  box-shadow:
    0 8px 14px rgba(122,92,255,.25),
    inset 0 2px 0 rgba(0,0,0,.25);
}
